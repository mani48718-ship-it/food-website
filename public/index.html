<!DOCTYPE html>
<html>
<head>
    <title>SMK Restaurant</title>

    <style>
        body{
            font-family: Arial;
            background:#f5f5f5;
            text-align:center;
            margin:0;
        }

        header{
            background:#ff4d4d;
            color:white;
            padding:18px;
            font-size:30px;
            font-weight:bold;
        }

        h2{
            margin-top:25px;
        }

        .food{
            background:white;
            width:250px;
            padding:15px;
            margin:15px;
            display:inline-block;
            border-radius:12px;
            box-shadow:0 0 10px #ccc;
        }

        button{
            background:#28a745;
            color:white;
            border:none;
            padding:10px 15px;
            border-radius:6px;
            cursor:pointer;
            font-size:16px;
        }

        input{
            padding:10px;
            width:250px;
            border-radius:6px;
            border:1px solid #ccc;
        }

        #orderForm{
            margin-top:25px;
        }
    </style>
</head>

<body>

<header>üçî SMK Restaurant</header>

<h2>Menu</h2>
<div id="menu">Loading menu...</div>

<h2>Place Your Order</h2>

<div id="orderForm">
<input id="name" placeholder="Your Name"><br><br>
<input id="phone" placeholder="Phone Number"><br><br>
<input id="address" placeholder="Delivery Address"><br><br>
</div>

<script>

/* ---------- LOAD MENU ---------- */
function loadMenu(){
    fetch('/menu')
    .then(res => res.json())
    .then(items => {

        const menuDiv = document.getElementById("menu");
        menuDiv.innerHTML = "";

        if(items.length === 0){
            menuDiv.innerHTML = "<h3>No food items added by admin yet</h3>";
            return;
        }

        items.forEach(item => {
            menuDiv.innerHTML += `
            <div class="food">
                <h2>${item.item_name}</h2>
                <p><b>Price: ‚Çπ${item.price}</b></p>
                <button onclick="placeOrder('${item.item_name}', ${item.price})">
                    Order Now
                </button>
            </div>
            `;
        });

    })
    .catch(()=>{
        document.getElementById("menu").innerHTML="Server not responding";
    });
}

loadMenu();


/* ---------- PLACE ORDER ---------- */
async function placeOrder(item, price){

    const name = document.getElementById("name").value;
    const phone = document.getElementById("phone").value;
    const address = document.getElementById("address").value;

    if(!name || !phone || !address){
        alert("‚ö† Please fill name, phone and address first");
        return;
    }

    try{
        const res = await fetch("/place-order",{
            method:"POST",
            headers:{
                "Content-Type":"application/json"
            },
            body: JSON.stringify({
                customer_name: name,
                phone: phone,
                address: address,
                food_item: item,
                quantity: 1,
                total_price: price
            })
        });

        const data = await res.json();

        if(data.message){
            alert("‚úÖ Order Confirmed!\nPay Cash on Delivery.");
        }else{
            alert("Order failed");
        }

    }catch(err){
        alert("Server error");
    }
}

</script>

</body>
</html>