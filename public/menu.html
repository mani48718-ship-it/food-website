<!DOCTYPE html>

<html>
<head>
<title>SMK Restaurant</title>

<style>
body{
font-family:Arial;
background:#f5f5f5;
margin:0;
}

/* HEADER */
.topHeader{
display:flex;
align-items:center;
justify-content:space-between;
background:#ff4d4d;
color:white;
padding:12px 20px;
position:sticky;
top:0;
z-index:1000;
}

.centerHeader{
font-size:26px;
font-weight:bold;
flex:1;
text-align:center;
}

.profileBtn{
background:white;
color:#ff4d4d;
padding:8px 12px;
border-radius:50%;
cursor:pointer;
font-size:20px;
}

.trackBtn{
background:white;
color:#ff4d4d;
padding:8px 14px;
border-radius:8px;
text-decoration:none;
font-weight:bold;
}

/* LAYOUT */
.mainLayout{
display:flex;
align-items:flex-start;
}

.menuArea{
width:75%;
padding:20px;
display:flex;
flex-wrap:wrap;
justify-content:center;
}

.food{
background:white;
width:250px;
padding:15px;
margin:15px;
border-radius:12px;
box-shadow:0 0 10px #ccc;
text-align:center;
}

button{
background:#28a745;
color:white;
border:none;
padding:10px 15px;
border-radius:6px;
cursor:pointer;
font-size:16px;
}

/* CART */
#cartBox{
width:25%;
min-width:300px;
background:white;
padding:15px;
border-left:3px solid #eee;
height:calc(100vh - 80px);
position:sticky;
top:80px;
overflow-y:auto;
box-shadow:-3px 0 10px rgba(0,0,0,0.08);
}

#cartItems{
max-height:60vh;
overflow-y:auto;
text-align:left;
}

#confirmBtn{
background:#ff4d4d;
width:100%;
margin-top:10px;
}

/* PROFILE MODAL */
.modal{
display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.5);
z-index:2000;
}

.modalContent{
background:white;
width:300px;
margin:120px auto;
padding:20px;
border-radius:12px;
text-align:center;
box-shadow:0 10px 30px rgba(0,0,0,0.3);
}

.modalContent input{
width:90%;
padding:10px;
margin:8px;
border-radius:6px;
border:1px solid #ccc;
}
</style>

</head>

<body>

<header class="topHeader">
<div class="profileBtn" onclick="openProfile()">üë§</div>
<div class="centerHeader">üçî SMK Restaurant</div>
<a href="/track.html" class="trackBtn">üì¶ Track Order</a>
</header>

<div class="mainLayout">

<div class="menuArea">
<h2 style="width:100%;text-align:center;">Menu</h2>
<div id="menu">Loading menu...</div>
</div>

<div id="cartBox">
<h3>üõí Your Cart</h3>
<div id="cartItems">No items</div>
<h3>Total: ‚Çπ<span id="total">0</span></h3>
<button id="confirmBtn" onclick="confirmOrder()">Confirm Order</button>
</div>

</div>

<!-- PROFILE POPUP -->

<div id="profileModal" class="modal">
  <div class="modalContent">
    <h2>üë§ Your Details</h2>

```
<input id="p_name" placeholder="Your Name">
<input id="p_phone" placeholder="Phone Number">
<input id="p_address" placeholder="Delivery Address">

<button onclick="saveProfile()">Save</button>
<br><br>
<button onclick="closeProfile()" style="background:#888;">Close</button>
```

  </div>
</div>

<script>

/* CART */
let cart = JSON.parse(localStorage.getItem("cart")) || {};
let total = 0;

function saveCart(){
localStorage.setItem("cart", JSON.stringify(cart));
}

/* MENU LOAD */
function loadMenu(){
fetch('/menu')
.then(res=>res.json())
.then(items=>{
const menuDiv=document.getElementById("menu");
menuDiv.innerHTML="";
items.forEach(item=>{
menuDiv.innerHTML += `
<div class="food">
<h2>${item.item_name}</h2>
<p><b>Price: ‚Çπ${item.price}</b></p>
<button onclick="addToCart('${item.item_name}', ${item.price})">Add</button>
</div>`;
});
});
}

/* CART FUNCTIONS */
function addToCart(name, price){
if(!cart[name]) cart[name]={qty:1,price:price};
else cart[name].qty++;
updateCart();
}

function increaseQty(name){cart[name].qty++;updateCart();}
function decreaseQty(name){
cart[name].qty--;
if(cart[name].qty<=0) delete cart[name];
updateCart();
}

function updateCart(){
const cartDiv=document.getElementById("cartItems");
cartDiv.innerHTML="";
total=0;

for(let item in cart){
let qty=cart[item].qty;
let price=cart[item].price*qty;
total+=price;

cartDiv.innerHTML+=`
<div>
<b>${item}</b><br>
<button onclick="decreaseQty('${item}')">‚àí</button>
<span style="margin:0 10px;">${qty}</span>
<button onclick="increaseQty('${item}')">+</button>
<div>‚Çπ${price}</div>
<hr>
</div>`;
}
document.getElementById("total").innerText=total;
saveCart();
}

/* PROFILE */
function openProfile(){
document.getElementById("profileModal").style.display="block";
document.getElementById("p_name").value=localStorage.getItem("cust_name")||"";
document.getElementById("p_phone").value=localStorage.getItem("cust_phone")||"";
document.getElementById("p_address").value=localStorage.getItem("cust_address")||"";
}

function closeProfile(){
document.getElementById("profileModal").style.display="none";
}

function saveProfile(){
localStorage.setItem("cust_name",document.getElementById("p_name").value);
localStorage.setItem("cust_phone",document.getElementById("p_phone").value);
localStorage.setItem("cust_address",document.getElementById("p_address").value);
alert("Saved ‚úî");
closeProfile();
}

/* PAGE LOAD */
window.onload=function(){
loadMenu();
updateCart();
};
</script>

</body>
</html>
